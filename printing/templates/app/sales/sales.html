{% extends "app/base/base.html" %}
{% block title %}Sales Order{% endblock %}
{% block header %}Sales Order{% endblock %}
{% block content %}
<div class="row">
    <div class="col-7">
        <div class="card shadow mb-3">
            <div class="card-header py-3">
                <p class="text-primary m-0 fw-bold">Products<p>
            </div>
            <div class="card-body">
                <div class="row-fluid">
                    {% for catagory, inv in inventory | groupby('catagory') %}
                    <h3 class="mt-5">{{catagory}}</h3>
                    {% for inv in inventory %}
                    {% if inv.catagory == catagory %}

                    {% if loop.index0 % 3 == 0 %}
                    <div class="row">
                        {% endif %}

                        <div class="col-4 d-grid gap-2">
                            <form action="{{url_for('sales.add_item', receipt=receipt, itemid = inv.id)}}"
                                method="POST">
                                <button class="btn btn-lg btn-block text-center btn-success">
                                    {{inv.project_name|truncate(12,true,'') }}<br>
                                    {{"$%.2f"%inv.sale_price}}<br>
                                    InStock: ({{inv.current_quantity}})<br>
                                </button>
                            </form>
                        </div>

                        {% if loop.index0 % 3 == 2 or loop.last %}
                    </div><br>
                    {% endif %}
                    {% endif %}
                    {% endfor %}
                    {% endfor %}

                </div>
            </div>
        </div>
    </div>
    <div class="col-5">
        <div class="card shadow mb-3">
            <div class="card-header py-3">
                <p class="text-primary m-0 fw-bold">Receipt<p>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        Receipt Number: {{receipt[0]}}<br>
                        Date/Time: {{receipt[1]}}<br>
                        Employee: {{receipt[2]}}.<br>
                        <hr>
                        <table width="100%" class="table table-striped table-active">
                            <thead>
                                <tr>
                                    <th width="60%" class="text-start">Item</th>
                                    <th width="20%" class="text-start">Quantity</th>
                                    <th width="20%" class="text-end">Price</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="text-start">Gingerbread man</td>
                                    <td class="text-start">1</td>
                                    <td class="text-end">$5.00</td>
                                </tr>
                                {% if numdic != 0 %}
                                {% for dict_item in receipt %}
                                {% if loop.index > 3 %}
                                <tr>
                                    {% for key, value in dict_item[loop.index-3].items() %}
                                    {% if loop.index > 1 %}
                                    <td>{{value}}</td>
                                    {% endif %}
                                    {% endfor %}
                                </tr>
                                {% endif %}
                                {% endfor %}
                                {% endif %}
                            </tbody>
                        </table>
                        {{receipt}}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}